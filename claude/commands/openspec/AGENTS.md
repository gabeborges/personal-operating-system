# OpenSpec – Agent Instructions (SDD-aligned)

Instructions for AI agents using OpenSpec within a Spec-Driven Development (SDD) workflow,
with Clavix as the upstream source of product intent.

This repository uses a build-versioned structure under .ops/build/ to avoid ambiguity,
enable parallel builds, and ensure deterministic agent behavior.

---

## Canonical Sources of Truth (Priority Order)

Agents MUST treat the following files as authoritative, in this order:

1. .ops/build/product-vision-strategy.md
   → High-level product vision, strategy, constraints (generated by Clavix)

2. .ops/build/v{x}/prd.md
   → Build-specific scope, goals, acceptance criteria (generated by Clavix)

3. .ops/build/v{x}/<feature-name>/spec.md
   → Feature-level requirements and scenarios (generated by OpenSpec)

If any of these are missing, stale, or ambiguous, STOP and ask for clarification.

---

## Terminology (Strict)

Old Term        → New Term (MANDATORY)
capability     → feature-name
project.md     → prd.md
tasks.md       → epic.md
openspec/specs → .ops/build/v{x}/

Agents MUST NOT reintroduce old terminology.

---

## Directory Structure (Authoritative)

.ops/
└── build/
    ├── product-vision-strategy.md
    └── v{x}/
        ├── prd.md
        ├── epic.md
        └── <feature-name>/
            ├── spec.md
            └── design.md (optional)

Any output that does not conform to this structure is invalid.

---

## Three-Stage SDD Workflow

Stage 1 – Proposal (Planning & Specification)
- Read product-vision-strategy.md and prd.md
- Define features
- Write spec.md per feature
- Write epic.md
- Validate strictly

Stage 2 – Apply (Implementation)
- Implement only approved specs
- Follow epic.md sequentially
- Do not change specs during implementation

Stage 3 – Archive (Post-Deployment)
- Archive build
- Re-validate

---

## Agent Rules

- Do not invent context
- Do not mix build versions
- Do not bypass validation
- Ask when uncertain

---

Mental model:
Clavix defines intent.
OpenSpec defines truth.
Code implements truth.
